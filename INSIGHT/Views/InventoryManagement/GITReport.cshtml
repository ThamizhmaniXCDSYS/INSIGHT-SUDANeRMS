@{
    ViewBag.Title = "GITReport";
    Layout = "~/Views/Shared/NewMaster.cshtml";
}
<style type="text/css">
    #dvLoading
    {
        /*background: url("../../../Images/Sun.gif") no-repeat center center;*/
        background: url("../Images/Sun.gif") no-repeat center center;
        height: 100%;
        width: 100%;
        position: fixed;
        z-index: 1000;
        left: 0%;
        top: 15%;
        margin: -25px 0 0 -25px;
    }
</style>
<div id="divDocuments">
    <table class="WithBorderOnly" width="100%">
        <tr class="PanelHeading">
            <td colspan="8" class="PanelHeading">
                <i class="icon-chevron-right"></i>&nbsp;GIT Report&nbsp;
            </td>
        </tr>
        <tr>
            <td>
                <input type="button" id="btnGITGenerate" value="Generate GIT Report" />
            </td>
        </tr>
    </table>
</div>
<table id="ExcelDocumentList">
</table>
<div id="ExcelDocumentListPager">
</div>
<div id="dvLoading"></div>
<script type="text/javascript">
    $(function () {
        $('#dvLoading').hide()
       .ajaxStart(function () {
           $(this).hide(); // show on any Ajax event.
       })
        GetExcelDocumentList();
        $("#btnGITGenerate").click(function () {
            var Ids = $("#ExcelDocumentList").jqGrid('getGridParam', 'selarrrow');
            $('#dvLoading').hide()
            .ajaxStart(function () {
                $(this).show(); // show on any Ajax event.
            })
            $.ajax({
                type: 'GET',
                dataType: "json",
                url: '@Url.Content("~/InventoryManagement/GITReportJQGrid")?Status=OPEN',
                success: function (data) {
                    debugger;
                    $('#dvLoading').hide()
                    .ajaxStop(function () {
                        $(this).hide(); // hide it when it is done.
                    });
                    if (data != 0) {
                        SucessMsg(" Documents Successfully Generated");
                    }
                    else {
                        ErrMsg("No GIT Generated ");
                    }
                    $("#ExcelDocumentList").setGridParam(
                    {
                        datatype: "json",
                        url: '@Url.Content("~/ExcelGeneration/InventoryExcelDocumentListJQGrid")?ExcelState=GITReport',
                                page: 0
                            }).trigger("reloadGrid");
                        }
            });
        }
    );
    });
            function GetExcelDocumentList() {
                $('#ExcelDocumentList').jqGrid('GridUnload');
                jQuery("#ExcelDocumentList").jqGrid({
                    mtype: 'GET',
                    url: '@Url.Content("~/ExcelGeneration/InventoryExcelDocumentListJQGrid")?ExcelState=GITReport',
                datatype: 'json',
                height: '335',
                width: '1200',
                shrinkToFit: true,
                colNames: ['Id', 'GIT Name', 'Generated By', 'Generated Date', 'Download'],
                colModel: [
                    { name: 'Id', index: 'Id', key: true, hidden: true },
                    { name: 'ControlId', index: 'ControlId', width: 300 },
                    { name: 'CreatedBy', index: 'CreatedBy' },
                    { name: 'CreatedDate', index: 'CreatedDate' },
                    { width: 200 }
                ],

                pager: '#ExcelDocumentListPager',
                rowNum: '100',
                rowList: [100, 200, 300, 400],
                sortname: 'Id',
                sortorder: "ASC",
                viewrecords: true,
                caption: '&nbsp;<i class="icon-th-list"></i>&nbsp;Excel Document Management',
                multiselect: true,
                viewrecords: true
            });
            $('#ExcelDocumentList').jqGrid('filterToolbar', { searchOnEnter: true, enableClear: false, afterSearch: function () { $('#ExcelDocumentList').clearGridData(); } });
        @*jQuery("#ExcelDocumentList")
              .navGrid('#ExcelDocumentListPager', { edit: false, add: false, del: false, search: false, refresh: false })
                 .navButtonAdd('#ExcelDocumentListPager', {
                     caption: "EXCEL ZIP Download",
                     onClickButton: function () {
                         var searchItems = $('#Sector').val() + ',' + $('#Contingent').val() + ',' + $('#contingentType').val() + ',' + $('#Period').val() + ',' + $('#PeriodYear').val() + ',' + $('#Week').val();
                         var Period = $('#Period').val();
                         if ($('#Sector').val() == "") {
                             ErrMsg("Please Select Sector");
                             return false;
                         }
                         if ($('#contingentType').val() == "") {
                             ErrMsg("Please Select ContingentType");
                             return false;
                         }
                         if ($('#PeriodYear').val() == "") {
                             ErrMsg("Please Select Period Year");
                             return false;
                         }
                         if (Period == "") {
                             ErrMsg("Please Select Period");
                             return false;
                         }
                         if ($('#Week').val() == "") {
                             ErrMsg("Please Select Week Year");
                             return false
                         }
                         else {
                             window.open('@Url.Content("~/Invoice/DownloadZipFiles")?searchItems=' + searchItems + '&PDF=' + false + '&EXCEL=' + true + '&invType=' + "Excel-Single", '_blank');
            }
                     }
                 })*@
        }
</script>
